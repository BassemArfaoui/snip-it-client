<div class="min-h-screen bg-background-light dark:bg-background-dark py-8">
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
    @if (loading) {
      <div class="flex items-center justify-center py-12">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
      </div>
    } @else {
      <!-- Header -->
      <div class="mb-8">
        <a
          [routerLink]="['/issues', issueId]"
          class="inline-flex items-center gap-1 text-text-muted dark:text-gray-400 hover:text-text-main dark:hover:text-white transition-colors mb-4"
        >
          <span class="material-symbols-outlined">arrow_back</span>
          <span>Back to Issue</span>
        </a>
        <h1 class="text-3xl font-bold text-text-main dark:text-white mb-2">Edit Issue</h1>
        <p class="text-text-muted dark:text-gray-400">
          Update your issue details
        </p>
      </div>

      <!-- Form Card -->
      <div class="bg-white dark:bg-card-dark rounded-2xl shadow-soft border border-gray-100 dark:border-white/10 p-8">
        @if (error) {
          <div class="mb-6 flex items-center gap-2 p-4 bg-danger-light dark:bg-danger-dark/20 border border-danger-light dark:border-danger-dark rounded-lg text-danger-dark dark:text-danger-light">
            <span class="material-symbols-outlined">error</span>
            <span>{{ error }}</span>
          </div>
        }

        <form [formGroup]="issueForm" (ngSubmit)="onSubmit()" class="space-y-6">
          <!-- Content Field -->
          <div>
            <label for="content" class="block text-sm font-semibold text-text-main dark:text-white mb-2">
              Issue Description *
            </label>
            <textarea
              id="content"
              formControlName="content"
              rows="8"
              class="w-full px-4 py-3 rounded-lg border text-text-main dark:text-white bg-white dark:bg-background-dark transition-colors focus:ring-2 focus:ring-primary focus:border-transparent"
              [class.border-gray-300]="!content?.invalid || !content?.touched"
              [class.border-red-500]="content?.invalid && content?.touched"
              placeholder="Describe the problem you're facing in detail...">
            </textarea>
            
            @if (content?.invalid && content?.touched) {
              <p class="mt-2 text-sm text-red-600 dark:text-red-400">
                @if (content?.errors?.['required']) {
                  Issue description is required
                } @else if (content?.errors?.['minlength']) {
                  Issue description must be at least 10 characters long
                }
              </p>
            }
            <p class="mt-2 text-sm text-text-muted dark:text-gray-400">
              {{ content?.value?.length || 0 }} characters (minimum 10)
            </p>
          </div>

          <!-- Language Field -->
          <div>
            <label for="language" class="block text-sm font-semibold text-text-main dark:text-white mb-2">
              Programming Language *
            </label>
            <select
              id="language"
              formControlName="language"
              class="w-full px-4 py-3 rounded-lg border text-text-main dark:text-white bg-white dark:bg-background-dark transition-colors focus:ring-2 focus:ring-primary focus:border-transparent"
              [class.border-gray-300]="!language?.invalid || !language?.touched"
              [class.border-red-500]="language?.invalid && language?.touched">
              <option value="" disabled>Select a language</option>
              @for (lang of languages; track lang) {
                <option [value]="lang">{{ lang }}</option>
              }
            </select>
            
            @if (language?.invalid && language?.touched) {
              <p class="mt-2 text-sm text-red-600 dark:text-red-400">
                Please select a programming language
              </p>
            }
          </div>

          <!-- Submit Buttons -->
          <div class="flex gap-3 pt-4">
            <button
              type="submit"
              [disabled]="submitting"
              class="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-primary hover:bg-primary/90 text-black font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
            >
              @if (submitting) {
                <span class="animate-spin material-symbols-outlined">progress_activity</span>
                <span>Saving...</span>
              } @else {
                <span class="material-symbols-outlined">save</span>
                <span>Save Changes</span>
              }
            </button>
            
            <a
              [routerLink]="['/issues', issueId]"
              class="px-6 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-white/5 dark:hover:bg-white/10 text-text-main dark:text-white font-semibold rounded-lg transition-colors text-center"
            >
              Cancel
            </a>
          </div>
        </form>
      </div>
    }
  </div>
</div>
